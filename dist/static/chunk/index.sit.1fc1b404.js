var le=Object.defineProperty;var se=(i,r,l)=>r in i?le(i,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[r]=l;var S=(i,r,l)=>(se(i,typeof r!="symbol"?r+"":r,l),l);import{r as x,j as u}from"./basic.sit.f8930ab3.js";import"../js/index.sit.a533c3c4.js";import{C as oe,a as ie}from"./index.sit.b8879e75.js";import{e as G,m as B}from"./vendor.sit.900beeae.js";import"./moment.sit.ddac5eea.js";class Z{constructor({x:r,y:l,z:g,key:m,baseWidth:e=20,baseHeight:d=21}){S(this,"x");S(this,"y");S(this,"z");S(this,"key");S(this,"val");S(this,"content");S(this,"style");S(this,"show");this.x=r,this.y=l,this.z=g,this.key=m,this.show=!0,this.style={top:`${l*d}px`,left:`${r*e}px`,width:`${e*2-2}px`,height:`${d*2-8}px`}}setValue(r){this.val=r,this.content=oe[r],Object.assign(this.style,ie[r])}}const re=({x:i,y:r,z:l,cardRandom:g,baseHeight:m,baseWidth:e})=>{const d=(i-1)*2,f=(r-1)*2+1;let n=0;const s=new Array(l).fill(0).map(h=>new Array(f).fill(0).map(M=>new Array(d).fill(0))),k=[];for(let h=0;h<l;h+=1){const M=Math.floor((l-h)/3);for(let v=M;v<f-M;v+=1){const D=Math.ceil((d-M)/2);console.log(D);for(let o=M;o<=D;o+=1){let b=!0;if(o>0&&s[h][v][o-1]&&(b=!1),v>0&&s[h][v-1][o]&&(b=!1),v>0&&o>0&&s[h][v-1][o-1]&&(b=!1),v>0&&s[h][v-1][o+1]&&(b=!1),Math.random()>g&&(b=!1),b){n+=1;const w=new Z({x:v,y:o,z:h,key:n,baseWidth:e,baseHeight:m});if(s[h][v][o]=w,k.push(w),o<D){n+=1;const L=new Z({x:d-v,y:o,z:h,key:n,baseWidth:e,baseHeight:m});s[h][v][d-o]=L,k.push(L)}}}}}const j=k.splice(0,n%3);for(const{x:h,y:M,z:v}of j)s[v][M][h]=0;return console.log(k),[s,k]},ae=({maxCardType:i},r)=>{const l=new Array(i);r.forEach(m=>{const e=Math.ceil(Math.random()*i);l[e]=l[e]?[...l[e],m]:[m],l[e]&&l[e].length%3===0&&(l[e].map(d=>d.setValue(e)),l[e]=null)});const g=l.reduce((m,e)=>[...m,...e||[]],[]);for(let m=0;m<g.length;m+=3){const e=Math.ceil(Math.random()*i);for(let d=m;d<m+3;d+=1)g[d].setValue(e)}return r},H=({x:i,y:r},l)=>{const g=(i-1)*2,m=(r-1)*2+1,e=new Array(m).fill(0).map(d=>new Array(g).fill(!1));for(let d=l.length-1;d>=0;d-=1){const f=l[d];if(f.show){const{x:n,y:s}=f;Math.abs(s-m)===1?(e[s][n]||e[s][n+1]||e[s-1][n]||e[s-1][n+1]?f.cover=!0:f.cover=!1,e[s][n]=!0,e[s-1][n]=!0,e[s][n+1]=!0,e[s-1][n+1]=!0):(e[s][n]||e[s][n+1]||e[s+1][n]||e[s+1][n+1]?f.cover=!0:f.cover=!1,e[s][n]=!0,e[s+1][n]=!0,e[s][n+1]=!0,e[s+1][n+1]=!0)}}return l},F=(i,r)=>r.findIndex(l=>l.key===i.key);var c="D:\\my-project\\vite-react-ts-eslint\\src\\pages\\MyTerritory\\ChickenAChicken\\components\\Game\\index.tsx";const Y={SAVE:u("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"9952",width:"40",height:"40",children:[u("path",{d:"M695.15 479.59c-132.66 0-240.2 107.54-240.2 240.2S562.49 960 695.15 960A238.47 238.47 0 0 0 868 888a234.15 234.15 0 0 0 67.11-169.64c-0.16-132-107.31-238.92-239.33-238.76zM698 899.22A178.28 178.28 0 0 1 695.15 543a181.44 181.44 0 0 1 182.6 176.55 177.7 177.7 0 0 1-175.66 179.67q-2.03 0.02-4.09 0z",fill:"#f4ea2a","p-id":"9953"},void 0,!1,{fileName:c,lineNumber:9,columnNumber:7},void 0),u("path",{d:"M753 605.45l-69.41 66.82a28.8 28.8 0 0 0-19.3 28.8v135.65a28.8 28.8 0 0 0 30.82 30.82 31.68 31.68 0 0 0 31.1-30.82v-120.1l67.11-67.39a28.8 28.8 0 0 0 0-43.49 27.07 27.07 0 0 0-40.32-0.29z",fill:"#f4ea2a","p-id":"9954"},void 0,!1,{fileName:c,lineNumber:14,columnNumber:7},void 0),u("path",{d:"M483.18 883.09H218.79A135.36 135.36 0 0 1 84 748V198.79A135.08 135.08 0 0 1 218.79 64h538.28a135.08 135.08 0 0 1 134.79 134.79v339l-22.75-22.46a254.6 254.6 0 0 0-39.75-32.54l-5.76-4V198.5a66.53 66.53 0 0 0-51-64.23V311.4a92.45 92.45 0 0 1-92.45 92.45H298.57a92.45 92.45 0 0 1-92.45-92.45V133.7a66.82 66.82 0 0 0-53.57 65.09V748a66.53 66.53 0 0 0 66.53 66.53h220.61l3.46 7.49a294.34 294.34 0 0 0 24.48 39.75zM274.66 132.55V311.4a23.9 23.9 0 0 0 23.9 23.9h381a24.48 24.48 0 0 0 24.19-23.9V132.55z",fill:"#f4ea2a","p-id":"9955"},void 0,!1,{fileName:c,lineNumber:19,columnNumber:7},void 0),u("path",{d:"M593.2 306.21a40.32 40.32 0 0 1-40.32-40.32v-60.77a40.32 40.32 0 1 1 80.64 0v60.48a40.32 40.32 0 0 1-40 40.61z",fill:"#f4ea2a","p-id":"9956"},void 0,!1,{fileName:c,lineNumber:24,columnNumber:7},void 0)]},void 0,!0,{fileName:c,lineNumber:8,columnNumber:5},void 0),RETRY:u("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1739",width:"40",height:"40",children:u("path",{d:"M921.6 585.728c0 226.304-184.32 409.6-409.6 409.6s-409.6-182.272-409.6-409.6c0-78.848 21.504-152.576 62.464-215.04l133.12 76.8c-25.6 39.936-39.936 87.04-39.936 138.24 0 142.336 114.688 254.976 254.976 254.976 142.336 0 257.024-114.688 257.024-254.976 0-118.784-79.872-219.136-189.44-247.808v131.072L196.608 248.832 577.536 28.672v151.552C772.096 214.016 921.6 381.952 921.6 585.728z",fill:"#f4ea2a","p-id":"1740"},void 0,!1,{fileName:c,lineNumber:33,columnNumber:7},void 0)},void 0,!1,{fileName:c,lineNumber:32,columnNumber:5},void 0),SHUFFLE:u("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4374",width:"40",height:"40",children:u("path",{d:"M6.070857 731.648c0 27.428571 20.150857 46.281143 50.578286 46.281143h97.718857c73.691429 0 118.272-21.430857 171.428571-83.565714l96.420572-112.292572 96 112.274286c53.138286 62.171429 97.28 84.004571 172.288 84.004571h78.427428v95.140572c0 23.149714 14.573714 37.723429 38.582858 37.723428 10.276571 0 20.992-3.84 28.708571-10.715428l161.993143-133.705143c19.712-15.872 19.291429-41.581714 0-57.435429l-162.011429-134.582857a44.105143 44.105143 0 0 0-28.708571-10.697143c-23.990857 0-38.582857 14.573714-38.582857 37.705143v83.145143H692.662857c-44.141714 0-71.570286-14.134857-106.715428-54.857143l-102.418286-119.570286 102.418286-119.149714c35.145143-41.142857 62.573714-55.277714 106.715428-55.277714h76.288v86.125714c0 23.168 14.573714 37.723429 38.582857 37.723429 10.276571 0 20.992-3.84 28.708572-10.715429l161.993143-133.705143c19.712-15.853714 19.291429-41.142857 0-57.417143l-162.011429-134.582857a44.105143 44.105143 0 0 0-28.708571-10.715428c-23.990857 0-38.582857 14.573714-38.582858 37.705143v92.580571h-78.409142c-75.008 0-119.149714 21.851429-172.288 84.004571l-96 112.274286-96.420572-112.274286c-53.156571-62.153143-97.718857-84.004571-171.446857-84.004571H56.649143c-30.427429 0-50.578286 18.852571-50.578286 46.72 0 27.428571 20.571429 46.701714 50.578286 46.701714h99.419428c41.581714 0 67.712 14.153143 102.436572 54.857143l102.418286 119.149714-102.418286 119.588572c-35.145143 40.704-61.293714 54.857143-102.436572 54.857143H56.649143c-29.988571 0-50.578286 19.273143-50.578286 46.701714z","p-id":"4375",fill:"#f4ea2a"},void 0,!1,{fileName:c,lineNumber:42,columnNumber:7},void 0)},void 0,!1,{fileName:c,lineNumber:41,columnNumber:5},void 0)},he=({config:i,changeWin:r})=>{const{x:l,y:g,baseWidth:m,baseHeight:e,retryNumber:d,shuffleNumber:f,saveNumber:n}=i,s=x.exports.useMemo(()=>((l-1)*2+2)*m,[i]),k=x.exports.useMemo(()=>((g-1)*2+1)*e,[i]),j=x.exports.useMemo(()=>(s-(l+2)*m*2)/2,[i]),[h,M]=x.exports.useState(0),[v,D]=x.exports.useState(0),[o,b]=x.exports.useState([]),[w,L]=x.exports.useState([]),[E,U]=x.exports.useState([]),[I,T]=x.exports.useState([]),[V,_]=x.exports.useState([]),[R,q]=x.exports.useState(d),[$,J]=x.exports.useState(n),[O,K]=x.exports.useState(f),Q=()=>{const[,t]=re(i),a=ae(i,t);M(a.length),b(H(i,a))};x.exports.useEffect(()=>{Q()},[]);const z=t=>t.map((a,N)=>({...a,style:{...a.style,top:0,left:`${j+(N+1)*m*2}px`}})),W=(t,a)=>{let N=-1,A=1,y=[],p=t;for(let C=p.length-1;C>=0;C-=1)p[C].val===a.val&&(N=N===-1?C:N,A+=1);if(A===3?(y=[...p.filter(C=>C.val===a.val),a],p=p.filter(C=>C.val!==a.val)):N>-1?p.splice(N,0,a):p.push(a),y=y.map(C=>({...C,style:{...C.style,top:"120%",left:`${j-60}px`}})),U([...E,...y]),L(z(p)),D([...E,...y].length),p.length>=7){r(!1);return}[...E,...y].length===h&&r(!0)},P=t=>{const a=F(t,o);_([...V,t]);const N=F(t,I);N>-1&&(I.splice(N,1),T(z(I))),o[a].show=!1,W(w,t),b(H(i,o))},X=()=>{if(I.length!==0||w.length===0){B.info("\u60A8\u73B0\u5728\u4E0D\u80FD\u4F7F\u7528\u6682\u5B58\u9053\u5177");return}if(!$){B.warn("\u60A8\u7684\u6682\u5B58\u6B21\u6570\u5DF2\u7528\u5B8C");return}J($-1),T(z(w.slice(0,3))),L(z(w.slice(3)))},ee=()=>{if(!O){B.warn("\u60A8\u7684\u6D17\u724C\u6B21\u6570\u5DF2\u7528\u5B8C");return}const t=o.length;o.forEach((a,N)=>{const A=Math.floor(t*Math.random()),y=o[A],p=a;o[N]={...a,x:y.x,y:y.y,z:y.z,style:{...a.style,left:y.style.left,top:y.style.top}},o[A]={...y,x:p.x,y:p.y,z:p.z,style:{...y.style,left:p.style.left,top:p.style.top}}}),o.sort((a,N)=>a.z-N.z),b([...H(i,o)]),K(O-1)},te=()=>{if(!V.length){B.info("\u4F60\u6682\u65F6\u8FD8\u6CA1\u6709\u4EFB\u4F55\u64CD\u4F5C");return}if(!R){B.warn("\u60A8\u7684\u64A4\u56DE\u6B21\u6570\u5DF2\u7528\u5B8C");return}for(;V.length;){const t=V.pop();if(F(t,E)<0){const a=F(t,w),N=F(t,I),A=F(t,o);a>-1&&w.splice(a,1),N>-1&&I.splice(N,1),o[A]={...t,show:!0},b([...o]),T(z(I)),L(z(w)),q(R-1);break}}_([...V]),b(H(i,o))};return u("div",{style:{width:s<160?160:s,height:k<170?170:k},className:"card-wrap",children:[u("div",{className:"tips",children:["\u5DF2\u6D88\u9664\u5361\u7247: ",v," / ",h]},void 0,!0,{fileName:c,lineNumber:284,columnNumber:7},void 0),o.map((t,a)=>t.show?u("div",{style:t.style,className:[t.cover&&"item-cover","card-item"].filter(Boolean).join(" "),onClick:()=>P(t),children:t.content},t.key,!1,{fileName:c,lineNumber:291,columnNumber:13},void 0):""),u("div",{className:"save-list",style:{width:3*m*2,height:e*2},children:I.map((t,a)=>u("div",{style:t.style,className:"card-item",onClick:()=>P(t),children:t.content},t.key,!1,{fileName:c,lineNumber:307,columnNumber:11},void 0))},void 0,!1,{fileName:c,lineNumber:304,columnNumber:7},void 0),u("div",{className:"select-list",style:{width:7*m*2,height:e*2},children:w.map((t,a)=>u("div",{style:t.style,className:"card-item",children:t.content},t.key,!1,{fileName:c,lineNumber:315,columnNumber:11},void 0))},void 0,!1,{fileName:c,lineNumber:312,columnNumber:7},void 0),u("div",{className:"tools",children:[u(G,{count:$,showZero:!0,children:u("div",{className:"tools-item",onClick:X,children:Y.SAVE},void 0,!1,{fileName:c,lineNumber:322,columnNumber:11},void 0)},void 0,!1,{fileName:c,lineNumber:321,columnNumber:9},void 0),u(G,{count:R,showZero:!0,children:u("div",{className:"tools-item",onClick:te,children:Y.RETRY},void 0,!1,{fileName:c,lineNumber:327,columnNumber:11},void 0)},void 0,!1,{fileName:c,lineNumber:326,columnNumber:9},void 0),u(G,{count:O,showZero:!0,children:u("div",{className:"tools-item",onClick:ee,children:Y.SHUFFLE},void 0,!1,{fileName:c,lineNumber:332,columnNumber:11},void 0)},void 0,!1,{fileName:c,lineNumber:331,columnNumber:9},void 0)]},void 0,!0,{fileName:c,lineNumber:320,columnNumber:7},void 0),E.map(t=>u("div",{style:t.style,className:"card-item",children:t.content},t.key,!1,{fileName:c,lineNumber:339,columnNumber:9},void 0))]},void 0,!0,{fileName:c,lineNumber:283,columnNumber:5},void 0)};export{he as default};
//# sourceMappingURL=index.sit.1fc1b404.js.map
